import requests
import time
import re
import string as String

EMAIL = "something@gmail.com"   # Your Gmail address
REFERRAL_CODE = ""               #5-6character reservation ID

# Works but runs through same address in same order every run
def dotify(address):
    return list(dotify_(address.split("@")[0].replace(".","") + "@" + address.split("@")[1]))

def dotify_(string):
    if len(string) == 1:
        yield string
        return

    for rest in dotify_(string[1:]):
        yield string[0] + rest
        yield string[0] + "." + rest

# Seems to be patched. Does not work
def plusify(address):
    while True:
        string = ''.join(random.choice(String.ascii_uppercase + String.digits) for _ in range(32))
        yield re.sub('@', '+'+string+'@', address)

for email in dotify(EMAIL):
    requestURL = "https://invites.oneplus.net/index.php?r=share/signup&success_jsonpCallback=success_jsonpCallback&email={0}&koid={1}&_=1438677876942".format(email.replace("@", "%40"), REFERRAL_CODE)
    print("Sending invite to " + email)
    res = requests.get(requestURL)
    while res.status_code != 200:
        print("Request failed. "+str(res.status_code))
        time.sleep(5)
        res = requests.get(requestURL)
    print("Successfully retreived response")
